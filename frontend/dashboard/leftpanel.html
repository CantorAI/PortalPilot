<!DOCTYPE html>
<html>
<head>
    <title>Dashboard - leftpanel </title>   
    <!--
    <script src="../../../../Galaxy/Javascript/parse_dataframe.js"></script>
    <script src="../../../../Galaxy/Javascript/draw.js"></script>
    <script src="../../../../Cantor/src/WebEngine/cantor.ws.js"></script>
    -->
    <script src="/c/users/victor/projects/CantorAI/Galaxy/Javascript/parse_dataframe.js"></script>
    <script src="/c/users/victor/projects/CantorAI/Galaxy/Javascript/draw.js"></script>
    <script src="/c/users/victor/projects/CantorAI/Cantor/src/WebEngine/cantor.ws.js"></script>
    <script>
        var socket = new CantorWebSocket("ws://localhost:8080");
        socket.connect();
        const filterList = [];

        async function FetchfilterList() {
            //filterList = [];
            //filterList.length = 0;
            //document.getElementById("output").innerHTML = "FetchfilterList() called"; 
            while(filterList.length > 0) {
                filterList.pop();
            }

            let retVal = await socket.call("retrieveFilterList");
            if (retVal == null || retVal.length < 2) {
                return;
            }
            let data = retVal[1];
            if (data == null) {
                return;
            }
			else {

                let output = '';
                document.getElementById('output_filterList').innerHTML = '';
                data = JSON.parse(retVal);
                // Display top categories 
                for (let cat in data) {
                     output += `<h4>${cat}</h4>`;
                    // output += `${cat}`;
                    // Display middle level items
                    for (let i=0; i<data[cat].length; i++) {
                        let filterName = Object.keys(data[cat][i])[0];
                        // let filterDll = Object.keys(data[cat][i])[1];
                        output += "<p>";
                        //output += "<button onclick='create_new_model()'>" 
                        output += "<button onclick='new"
                        output += filterName
                        output += "()'>" 
                        output += filterName;
                        output += "</button>";
                        output += "</p>";
                        // filterList.push({filterName, filterDll})
                        filterList.push(filterName)
                    }                    
                }
                document.getElementById('output_filterList').innerHTML = output;            
                updateSelect();
			}
        }

        //function create_new_model() {
        //  alert("Creating new model"); 
        //}
        //function save_model() {
        //  alert("save current model"); 
        //}
        var actMap = '{}';
        mgr = null;

        const nodeGraph_key = "nodeGraph";
        if (typeof _datastore !== "undefined") {
            if (_datastore.has(nodeGraph_key)) {
                mgr = _datastore.get(nodeGraph_key);
                mgr.reInit(idGraphDrawPad, actMap);
            }
            else {
                mgr = new GraphManager(idGraphDrawPad, actMap);
                _datastore.set(nodeGraph_key, mgr);
            }
        }
        else {
            mgr = new GraphManager(idGraphDrawPad, actMap);
        }

        function newdataset() {
            alert("Creating newDataset"); 
            let objType = "Dataset";
            let desc = "";
            let pinStr = '[\
                {\
                    "Name": "output",\
                        "Dir": "out",\
                            "frametypes": [\
                                "any"\
                            ]\
                }\
             ]';
            mgr.newObj(objType, desc, pinStr);
        }
        function newsink() {
            alert("Creating newsink"); 
            let objType = "Sink";
            let desc = "";
            let pinStr = '[\
                {\
                    "Name": "input",\
                        "Dir": "in",\
                            "frametypes": [\
                                "any"\
                            ]\
                }\
             ]';
            mgr.newObj(objType, desc, pinStr);
        }
        function newfermat() {
            alert("Creating newfermat"); 
            let objType = "Fermat";
            let desc = "";
            let pinStr = '[\
                {\
                    "Name": "input",\
                        "Dir": "in",\
                            "frametypes": [\
                                "any"\
                            ]\
                },\
                {\
                    "Name": "output",\
                        "Dir": "out",\
                            "frametypes": [\
                                "any"\
                            ]\
                }\
             ]';
            mgr.newObj(objType, desc, pinStr);
        }
        function newtee() {
            alert("Creating newtee"); 
            let objType = "Tee";
            let desc = "";
            let pinStr = '[\
                {\
                    "Name": "input",\
                        "Dir": "in",\
                            "frametypes": [\
                                "any"\
                            ]\
                },\
                {\
                    "Name": "output1",\
                        "Dir": "out",\
                            "frametypes": [\
                                "any"\
                            ]\
                },\
                {\
                    "Name": "output2",\
                        "Dir": "out",\
                            "frametypes": [\
                                "any"\
                            ]\
                }\
             ]';
            mgr.newObj(objType, desc, pinStr);
        }
        function newmux() {
            alert("Creating newmux"); 
            let objType = "Mux";
            let desc = "";
            let pinStr = '[\
                {\
                    "Name": "input1",\
                        "Dir": "in",\
                            "frametypes": [\
                                "any"\
                            ]\
                },\
                {\
                    "Name": "input2",\
                        "Dir": "in",\
                            "frametypes": [\
                                "any"\
                            ]\
                },\
                {\
                    "Name": "output",\
                        "Dir": "out",\
                            "frametypes": [\
                                "any"\
                            ]\
                }\
             ]';
            mgr.newObj(objType, desc, pinStr);
        }

    </script>
</head>

<body>
    <!--
    <div id="output_filterList" onload="FetchfilterList()"></div>
    -->
    <div>
        <p> <h4>Builtin Models(Filters)</h4></p>
    </div>
    <div>
        <button onclick="FetchfilterList()">Fetch Filter List</button>
    </div>
    <div id="output_filterList"></div>

    <!--
    <p> ------------------------</p>
    <div>
        DIY Models
        <button onclick="create_new_model()">New Model</button>
        <button onclick="save_model()">Save Model</button>

    </div>
    -->
    <p> ------------------------</p>
    <div>
        <p> <h4>Customerized Model</h4></p>
        <p> <button onclick="mgr.newNode()">New</button></p>
    </div>

    <p> ------------------------</p>
    <div> 
        <p> <h4>Download Third Party Models </h4></p>
        <p><a href="https://huggingface.co/">Hugging Face</a></p>
        <p><a href="https://civitai.com/">Civitai</a></p>
        <p><a href="https://discord.com/">Discord</a></p>
        <p><a href="https://www.modelzoo.co/">Model Zoo </a></p>
    </div>
    
</body>
</html>
